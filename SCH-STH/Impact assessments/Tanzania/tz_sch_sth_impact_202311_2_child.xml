<?xml version="1.0" encoding="UTF-8"?>
<h:html xmlns="http://www.w3.org/2002/xforms"
  xmlns:ev="http://www.w3.org/2001/xml-events"
  xmlns:h="http://www.w3.org/1999/xhtml"
  xmlns:jr="http://openrosa.org/javarosa"
  xmlns:odk="http://www.opendatakit.org/xforms"
  xmlns:orx="http://openrosa.org/xforms"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <h:head>
    <h:title>(2023 Nov) - 2. SCH/STH – Participant</h:title>
    <model odk:xforms-version="1.0.0">

      <instance>
        <data id="tz_sch_sth_impact_202311_2_child">
          <p_recorder/>
          <p_district/>
          <p_ward/>
          <p_site/>
          <p_site_id/>
          <p_consent_note/>
          <C1/>
          <p jr:template="">
            <C2/>
            <C3/>
            <p_consent/>
            <p_index/>
            <p_code_id/>
            <p_age_yrs/>
            <p_sex/>
            <p_collected_stool/>
            <p_collected_urine/>
            <p_macroscopique_hemat/>
            <p_ending_survey_note/>
            <p_sample_note/>
            <p_remarks/>
          </p>
          <p>
            <C2/>
            <C3/>
            <p_consent/>
            <p_index/>
            <p_code_id/>
            <p_age_yrs/>
            <p_sex/>
            <p_collected_stool/>
            <p_collected_urine/>
            <p_macroscopique_hemat/>
            <p_ending_survey_note/>
            <p_sample_note/>
            <p_remarks/>
          </p>
          <p_start/>
          <p_end/>
          <meta>
            <instanceID/>
          </meta>
        </data>
      </instance>

      <itext>
        <translation default="true()" lang="English">
          <text id="/data/p_recorder:jr:constraintMsg">
            <value>Must be two digit between 9 and 100</value>
          </text>
          <text id="/data/p_recorder:label">
            <value>Recorder code</value>
          </text>
          <text id="/data/p_district:label">
            <value>Select council</value>
          </text>
          <text id="/data/p_ward:label">
            <value>Select ward</value>
          </text>
          <text id="/data/p_site:label">
            <value>Select school</value>
          </text>
          <text id="/data/p_site_id:label">
            <value>Select school ID</value>
          </text>
          <text id="/data/p_consent_note:label">
            <value>Good morning ! I am here on behalf of the Ministry of Health. We are conducting a survey to determine the presence of schistosomiasis (SCH) and soil-transmitted helminthiasis (STH) in your school. I will ask you some questions about the mode and mechanism of transmission and would also appreciate collecting stool and urine samples from you. If you would like to participate in the survey, let me know and I will record your responses and provide you with stool and urine containers. If you agree, the survey will only take a few minutes. Participating in the school survey will directly benefit you because if worms are diagnosed, you will immediately receive deworming medication. Your community and school will also benefit directly, as the results of this survey will help the Ministry of Health implement deworming activities for children aged 5 to 14 years, if laboratory results reveal the need for interventions. You can refuse without penalty. Would you like to participate in our survey?</value>
          </text>
          <text id="/data/p/p_consent:label">
            <value>Has the child given consent and the consent of his or her parents or guardians?</value>
          </text>
          <text id="/data/p/p_consent:hint">
            <value>The answer "No" will end the survey</value>
          </text>
          <text id="/data/p/p_index:jr:constraintMsg">
            <value>This child code already exists. Please edit the sequence number from the previous question</value>
          </text>
          <text id="/data/p/p_index:label">
            <value>Please inter the child sequence number</value>
          </text>
          <text id="/data/p/p_code_id:label">
            <value>Child code</value>
          </text>
          <text id="/data/p/p_code_id:hint">
            <value>Copy this code into all registers and sample pots</value>
          </text>
          <text id="/data/p/p_age_yrs:jr:constraintMsg">
            <value>L'âge doit être compris entre 4 et 15 ans</value>
          </text>
          <text id="/data/p/p_age_yrs:label">
            <value>Enter the child's age in years</value>
          </text>
          <text id="/data/p/p_sex:label">
            <value>Select the gender of the child</value>
          </text>
          <text id="/data/p/p_collected_stool:label">
            <value>Was a stool sample taken from this child?</value>
          </text>
          <text id="/data/p/p_collected_stool:hint">
            <value>We do not want to go back if they do not give a sample because we cannot guarantee that there will be no exchange of samples.</value>
          </text>
          <text id="/data/p/p_collected_urine:label">
            <value>Was a urine sample taken from this child?</value>
          </text>
          <text id="/data/p/p_macroscopique_hemat:label">
            <value>Is the urine macroscopically hematuric?</value>
          </text>
          <text id="/data/p/p_ending_survey_note:label">
            <value>You have just entered a value which will end the survey</value>
          </text>
          <text id="/data/p/p_sample_note:label">
            <value>You have just entered a value which will cause the survey to end. Please collect stool and urine samples from the participant.</value>
          </text>
          <text id="/data/p/p_remarks:label">
            <value>Additional notes</value>
          </text>
          <text id="consent_list-0">
            <value>Gave</value>
          </text>
          <text id="consent_list-1">
            <value>Refused</value>
          </text>
          <text id="sex-0">
            <value>Femaile</value>
          </text>
          <text id="sex-1">
            <value>Male</value>
          </text>
          <text id="yesNo-0">
            <value>Yes</value>
          </text>
          <text id="yesNo-1">
            <value>No</value>
          </text>
        </translation>
      </itext>

      <instance id="consent_list">
        <root>
          <item>
            <itextId>consent_list-0</itextId>
            <name>Gave</name>
          </item>
          <item>
            <itextId>consent_list-1</itextId>
            <name>Refused</name>
          </item>
        </root>
      </instance>
      <instance id="sex">
        <root>
          <item>
            <itextId>sex-0</itextId>
            <name>Femaile</name>
          </item>
          <item>
            <itextId>sex-1</itextId>
            <name>Male</name>
          </item>
        </root>
      </instance>
      <instance id="yesNo">
        <root>
          <item>
            <itextId>yesNo-0</itextId>
            <name>Yes</name>
          </item>
          <item>
            <itextId>yesNo-1</itextId>
            <name>No</name>
          </item>
        </root>
      </instance>
      <bind constraint="regex(., '^[0-9]{2}$')" jr:constraintMsg="jr:itext('/data/p_recorder:jr:constraintMsg')" nodeset="/data/p_recorder" required="true()" type="int"/>
      <bind nodeset="/data/p_district" required="true()" type="string" db_get="col_1"/>
      <bind nodeset="/data/p_ward" required="true()" type="string" db_get="col_2" db_filter_by_col_1="/data/p_district"/>
      <bind nodeset="/data/p_site" required="true()" type="string" db_get="col_3" db_filter_by_col_2="/data/p_ward"/>
      <bind nodeset="/data/p_site_id" required="true()" type="string" db_get="col_4" db_filter_by_col_3="/data/p_site"/>
      <bind nodeset="/data/p_consent_note" readonly="true()" type="string"/>
      <bind calculate="join(' ',  /data/p/p_index )" nodeset="/data/C1" type="string"/>
      <bind calculate="position(..)" nodeset="/data/p/C2" type="string"/>
      <bind calculate="if ( ../C2  = 1,'',substring-after( /data/C1 , ../p_index ))" nodeset="/data/p/C3" type="string"/>
      <bind nodeset="/data/p/p_consent" required="true()" type="string"/>
      <bind constraint="not(selected( ../C3 ,  ../p_index ))" jr:constraintMsg="jr:itext('/data/p/p_index:jr:constraintMsg')" nodeset="/data/p/p_index" relevant=" ../p_consent  = 'Gave'" required="true()" type="int"/>
      <bind calculate="concat( /data/p_site_id , '_',  ../p_index )" nodeset="/data/p/p_code_id" readonly="true()" relevant=" ../p_consent  = 'Gave'" required="true()" type="string" db_add_col_4="/data/p_site_id" db_add_col_5="."/>
      <bind constraint=". &gt;= 5 and . &lt;= 14" jr:constraintMsg="jr:itext('/data/p/p_age_yrs:jr:constraintMsg')" nodeset="/data/p/p_age_yrs" relevant=" ../p_consent  = 'Gave'" required="true()" type="int"/>
      <bind nodeset="/data/p/p_sex" relevant=" ../p_consent  = 'Gave'" required="true()" type="string"/>
      <bind nodeset="/data/p/p_collected_stool" relevant=" ../p_consent  = 'Gave'" required="true()" type="string"/>
      <bind nodeset="/data/p/p_collected_urine" relevant=" ../p_consent  = 'Gave'" required="true()" type="string"/>
      <bind nodeset="/data/p/p_macroscopique_hemat" relevant=" ../p_consent  = 'Gave' and  ../p_collected_urine  = 'Yes'" type="string"/>
      <bind nodeset="/data/p/p_ending_survey_note" readonly="true()" relevant=" ../p_consent  = 'Refused'" type="string"/>
      <bind nodeset="/data/p/p_sample_note" readonly="true()" relevant=" ../p_collected_stool  = 'No' and  ../p_collected_urine  = 'No'" type="string"/>
      <bind nodeset="/data/p/p_remarks" type="string"/>
      <bind jr:preload="timestamp" jr:preloadParams="start" nodeset="/data/p_start" type="dateTime"/>
      <bind jr:preload="timestamp" jr:preloadParams="end" nodeset="/data/p_end" type="dateTime"/>
      <bind jr:preload="uid" nodeset="/data/meta/instanceID" readonly="true()" type="string"/>
    </model>
  </h:head>
  <h:body>
    <input ref="/data/p_recorder">
      <label ref="jr:itext('/data/p_recorder:label')"/>
    </input>
    <input ref="/data/p_district">
      <label ref="jr:itext('/data/p_district:label')"/>
    </input>
    <input ref="/data/p_ward">
      <label ref="jr:itext('/data/p_ward:label')"/>
    </input>
    <input ref="/data/p_site">
      <label ref="jr:itext('/data/p_site:label')"/>
    </input>
    <input ref="/data/p_site_id">
      <label ref="jr:itext('/data/p_site_id:label')"/>
    </input>
    <input ref="/data/p_consent_note">
      <label ref="jr:itext('/data/p_consent_note:label')"/>
    </input>
    <group ref="/data/p">
      <label></label>
      <repeat nodeset="/data/p">
        <select1 ref="/data/p/p_consent">
          <label ref="jr:itext('/data/p/p_consent:label')"/>
          <hint ref="jr:itext('/data/p/p_consent:hint')"/>
          <itemset nodeset="instance('consent_list')/root/item">
            <value ref="name"/>
            <label ref="jr:itext(itextId)"/>
          </itemset>
        </select1>
        <input ref="/data/p/p_index">
          <label ref="jr:itext('/data/p/p_index:label')"/>
        </input>
        <input ref="/data/p/p_code_id">
          <label ref="jr:itext('/data/p/p_code_id:label')"/>
          <hint ref="jr:itext('/data/p/p_code_id:hint')"/>
        </input>
        <input ref="/data/p/p_age_yrs">
          <label ref="jr:itext('/data/p/p_age_yrs:label')"/>
        </input>
        <select1 ref="/data/p/p_sex">
          <label ref="jr:itext('/data/p/p_sex:label')"/>
          <itemset nodeset="instance('sex')/root/item">
            <value ref="name"/>
            <label ref="jr:itext(itextId)"/>
          </itemset>
        </select1>
        <select1 ref="/data/p/p_collected_stool">
          <label ref="jr:itext('/data/p/p_collected_stool:label')"/>
          <hint ref="jr:itext('/data/p/p_collected_stool:hint')"/>
          <itemset nodeset="instance('yesNo')/root/item">
            <value ref="name"/>
            <label ref="jr:itext(itextId)"/>
          </itemset>
        </select1>
        <select1 ref="/data/p/p_collected_urine">
          <label ref="jr:itext('/data/p/p_collected_urine:label')"/>
          <itemset nodeset="instance('yesNo')/root/item">
            <value ref="name"/>
            <label ref="jr:itext(itextId)"/>
          </itemset>
        </select1>
        <select1 ref="/data/p/p_macroscopique_hemat">
          <label ref="jr:itext('/data/p/p_macroscopique_hemat:label')"/>
          <itemset nodeset="instance('yesNo')/root/item">
            <value ref="name"/>
            <label ref="jr:itext(itextId)"/>
          </itemset>
        </select1>
        <input ref="/data/p/p_ending_survey_note">
          <label ref="jr:itext('/data/p/p_ending_survey_note:label')"/>
        </input>
        <input ref="/data/p/p_sample_note">
          <label ref="jr:itext('/data/p/p_sample_note:label')"/>
        </input>
        <input ref="/data/p/p_remarks">
          <label ref="jr:itext('/data/p/p_remarks:label')"/>
        </input>
      </repeat>
    </group>
  </h:body>
</h:html>
